---
title: 象棋残局机器人二：投射变换
date: 2019-05-25 23:34:15
tags:
  - opencv
---

## 图片的几何变换
* 缩放
``` bash
img = cv2.imread("tmp.png", 1)
height, width, _ = img.shape  # (height, width, mode)
dstHeight = int(height*0.5)
dstWidth = int(width*0.5)
# cv2.resize()
# dst = cv2.resize(img, (dstWidth, dstHeight))
# 最近邻域插值
dstImage = np.zeros((dstHeight, dstWidth), np.uint8)
for i in range(0, dstHeight):
    for j in range(0, dstWidth):
        iNew = int(i * height * 1.0 / dstHeight)
        jNew = int(j * width * 1.0 / dstWidth)
        dstImage[i, j] = img(iNew, jNew)
cv2.imshow("img", dstImage)
# 双线性插值 
# 像素关系重采样 
# 立方插值
cv2.waitKey(0)
```
* 剪切
``` bash
# 图片坐标
# x: 0-width
# y: 0-height
img = cv2.imread("tmp.png", 1)
datImage = img[100:200, 100:300]
cv2.imshow("img", dstImage)
cv2.waitKey(0)
```
* 位移
``` bash
img = cv.imread("tmp.png", 1)
height, width, _ = img.shape  # (height, width, mode)
# cv2.warpAffine()
matShift = np.float32([[1,0,100], [0,1,200]]) # 2行3列
dstImage = cv2.warpAffine(img, matShift, (width, height))
cv2.imshow("img", dstImage)
cv2.waitKey(0)
```
* 镜像
``` bash
xImg  = cv.flip(img,1,dst=None)  #水平镜像
xImg1 = cv.flip(img,0,dst=None)  #垂直镜像
xImg2 = cv.flip(img,-1,dst=None) #对角镜像
```
* 仿射变换
``` bash
img = cv.imread("tmp.png", 1)
height, width, _ = img.shape  # (height, width, mode)
# src 3p -> dst 3p
matSrc = np.float32([[0,0], [0,height-1], [width-1, 0]])
matDst = np.float32([[50,50], [300,height-200], [width-300, 100]])
# 获得仿射变换矩阵
matAffine = cv2.getAffineTransform(matSrc, matDst)
dstImage = cv2.warpAffine(img, matAffine, (width, height))
cv2.imshow("img", dstImage)
cv2.waitKey(0)
```
* 旋转
``` bash
img = cv.imread("tmp.png", 1)
height, width, _ = img.shape  # (height, width, mode)
# 获得旋转矩阵
matRotate = cv2.getRotationMatrix2D((int(width/2), int(height/2)), 45, 0.5)
dstImage = cv2.warpAffine(img, matRotate, (width, height))
cv2.imshow("img2", dstImage)
cv2.waitKey(0)
```
## 仿射变换就是特殊的透射变换

* 透射变换
``` bash
matSrc = np.float32(points)
matDst = np.float32([[0,0],[0,399],[99, 0],[99,399]])
matPers = cv2.getPerspectiveTransform(matSrc, matDst)
dstImage = cv2.warpPerspective(img, matPers, (width, height))
```

<div align=center>
<img src='象棋残局机器人二：透射变换\001.jpg' width=600 height=300>
</div>

利用透射变换这一操作，从而将棋面的图像从背景中抽离转化成易于处理的形式。


## 参考资料

* 仿射变换和透射变换 - outthinker - 博客园 </br>https://www.cnblogs.com/zf-blog/p/7813227.html

* 4.1 图像特效介绍 - YouTube</br> https://www.youtube.com/watch?v=Ih2iamhLvxE&list=PLsYXQooxlb1pE21-dgEf-VdsArdqSvuEW&index=36
